<div class="grid gap-4 text-center">
    <p class="text-muted">Do you want to logout?</p>
</div>
<form onsubmit="reply(event, true)" id="loginForm" class="w-full">
    <div class="grid gap-4 py-8">
        <button
            class="whitespace-nowrap font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 h-9 px-3 flex items-center justify-center gap-1 rounded-full text-xs transition-[gap] duration-500 ease-in-out hover:gap-2 bg-transparent text-accent ring-1 ring-accent hover:bg-accent/10 w-full"
            type="submit">

            Logout
        </button>
        <button type="button" onclick="reply(event, false)"
            class="whitespace-nowrap font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 h-9 px-3 flex items-center justify-center gap-1 rounded-full text-xs transition-[gap] duration-500 ease-in-out hover:gap-2 bg-transparent text-accent ring-1 ring-red-400 hover:bg-accent/10 w-full ">
            Deny
        </button>
        <span id="error" class="text-sm text-red-600"></span>
    </div>
</form>

<script>
    function init() {
        const urlParams = new URLSearchParams(window.location.search);
        let isLoggedOut = urlParams.get('is_logged_out');
        if (isLoggedOut === 'true') {
            const message = document.createElement('p');
            message.className = 'text-lg text-center text-green-600';
            message.textContent = 'You have successfully been logged out';
            const form = document.getElementById('loginForm');
            form.parentNode.insertBefore(message, form);
            form.style.display = 'none';
        }
    }

    init();
    
    function reply(event, consent) {
        if (event?.preventDefault) {
            event.preventDefault();
        }

        hideError();

        const urlParams = new URLSearchParams(window.location.search);
        let callbackUrl = urlParams.get('callback_url');

        if (!callbackUrl) {
            displayError('Callback URL is missing.');
            return;
        }

        if (consent) {
            callbackUrl += (callbackUrl.includes('?') ? '&' : '?') + 'logout=true';
        } else {
            callbackUrl += (callbackUrl.includes('?') ? '&' : '?') + 'logout=false';
        }

        console.log("Redirecting to callback URL:", callbackUrl);

        window.location.href = callbackUrl;
    }
</script>