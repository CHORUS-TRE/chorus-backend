<div class="grid gap-4 text-center">
    <p class="text-muted">Enter your username below to login to your account</p>
</div>
<form onsubmit="login(event)" id="loginForm" class="w-full">
    <div class="grid gap-4 py-8">
        <div class="grid gap-2">
            <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                for="username">
                Username
            </label>
            <input
                class="flex h-10 w-full rounded-md px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm border border-muted/40 bg-background"
                id="username" required="" type="text" name="Username">
        </div>
        <div class="mb-2 grid gap-2">
            <div class="flex items-center">
                <label
                    class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                    for="password">
                    Password
                </label>
            </div>
            <input
                class="flex h-10 w-full rounded-md px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm border border-muted/40 bg-background text-muted"
                id="password" required="" autocomplete="current-password" type="password" name="password">
        </div>
        <div class="mb-2 grid gap-2 hidden">
            <div class="flex items-center">
                <label
                    class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                    for="error">
                    Error
                </label>
            </div>
            <span id="error" class="text-sm text-red-600"></span>
        </div>
        <button
            class="whitespace-nowrap font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 h-9 px-3 flex items-center justify-center gap-1 rounded-full text-xs transition-[gap] duration-500 ease-in-out hover:gap-2 bg-transparent text-accent ring-1 ring-accent hover:bg-accent/10 w-full"
            type="submit">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-arrow-right mr-2 h-4 w-4">
                <path d="M5 12h14"></path>
                <path d="m12 5 7 7-7 7"></path>
            </svg>
            Login
        </button>
    </div>
</form>

<script>
function login(event) {
    event.preventDefault();

    hideError();

    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;

    const data = {
        username: username,
        password: password
    };

    fetch('/api/rest/v1/authentication/login', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
        .then(response => response.json())
        .then(data => {
            if (data?.result?.token) {
                const urlParams = new URLSearchParams(window.location.search);
                const callbackUrl = urlParams.get('callback_url') || '/';
                window.location.href = callbackUrl;
            } else if (data?.message) {
                displayError(data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            displayError('An unexpected error occurred. Please try again later.' + error);
        });
}

</script>

<!-- <div class="grid gap-4">
    <div class="relative my-2">
        <div class="absolute inset-0 flex items-center"><span class="w-full border-t"></span></div>
        <div class="relative flex justify-center text-xs uppercase"><span
                class="bg-background px-2 text-muted">Or choose an account</span></div>
    </div><button
        class="whitespace-nowrap font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 h-9 px-3 flex items-center justify-center gap-1 rounded-full text-xs transition-[gap] duration-500 ease-in-out hover:gap-2 bg-transparent text-accent ring-1 ring-accent hover:bg-accent/10 w-full"
        type="button">keycloak<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round"
            class="lucide lucide-arrow-right ml-2 h-4 w-4">
            <path d="M5 12h14"></path>
            <path d="m12 5 7 7-7 7"></path>
        </svg></button><button
        class="whitespace-nowrap font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 h-9 px-3 flex items-center justify-center gap-1 rounded-full text-xs transition-[gap] duration-500 ease-in-out hover:gap-2 bg-transparent text-accent ring-1 ring-accent hover:bg-accent/10 w-full"
        type="button">keycloakdev<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round"
            class="lucide lucide-arrow-right ml-2 h-4 w-4">
            <path d="M5 12h14"></path>
            <path d="m12 5 7 7-7 7"></path>
        </svg></button>
</div> -->